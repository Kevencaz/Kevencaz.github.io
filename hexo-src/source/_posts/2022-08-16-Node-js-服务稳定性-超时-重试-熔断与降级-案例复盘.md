---
title: Node.js 服务稳定性：超时、重试、熔断与降级｜案例复盘
date: 2022-08-16 23:50:45
tags:
- Node.js
- 后端
---

> 稳定性不是零故障，而是“可恢复”。

<!-- more -->

## 开篇定位

这篇面向独立开发者，从成本视角拆解Node.js 服务稳定性，目标是用更少资源支撑同样吞吐。

深度定位：实战，重点是面向真实流量与团队协作。

我们先统一指标（QPS/成本、存储成本），再把动作拆成可验证步骤。

## 背景

依赖链路越长，波动越难避免。稳定性工程就是把失败变得可控、可预测、可恢复。

在从 0 到 1 的新项目阶段，最容易忽视的是过度优化导致投入失衡，先对齐度量口径能减少返工。

## 方法拆解

- 为所有外部调用设置超时与兜底。
- 重试要有限制，避免雪崩。
- 熔断触发后主动降级，保核心路径。

## 深度推进

- 容量评估与压测
- 流程标准化
- 持续优化与复盘

## 关键指标

- 核心指标：QPS/成本、存储成本
- 目标：用更少资源支撑同样吞吐
- 验证方式：上线后 7 天回看趋势

## 执行提示

- 建立演练机制
- 对齐多角色协作
- 形成指标周报

## 示例

~~~js
const controller = new AbortController();
const timer = setTimeout(() => controller.abort(), 1500);
const res = await fetch(url, { signal: controller.signal });
clearTimeout(timer);
~~~

## 常见误区

- 超时缺失导致线程堆积
- 无限重试放大故障
- 降级逻辑与业务耦合太深
- 过度优化导致投入失衡
- 避免单点依赖
- 提前准备峰值与故障剧本

## 工具与资料

- 文档：飞书/Notion 需求记录
- 监控：Grafana + Prometheus
- 告警：Sentry/自定义报警

## Checklist

- 核心依赖有超时
- 重试次数 <= 2
- 关键接口有降级策略
- 深度目标：团队协作下稳定交付
- 节奏：每周一发布
