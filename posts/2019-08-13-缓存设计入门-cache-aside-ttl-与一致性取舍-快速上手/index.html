<!DOCTYPE html><html lang="zh-CN"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Technology Stack"><title>ç¼“å­˜è®¾è®¡å…¥é—¨ï¼šCache Asideã€TTL ä¸ä¸€è‡´æ€§å–èˆï½œå¿«é€Ÿä¸Šæ‰‹ | Mystwood</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="stylesheet" href="/styles/global.css"><link rel="stylesheet" href="/_astro/Gitalk.B4AMVcrv.css">
<style>#gitalk-container{margin-top:60px;padding:20px;background:#0a0e1799;border:1px solid rgba(0,240,255,.2);border-radius:8px}.gt-container{color:#e0e0e0!important}.gt-container .gt-header-textarea{background:#0a0e17cc!important;border:1px solid rgba(0,240,255,.3)!important;color:#e0e0e0!important}.gt-container .gt-header-textarea:focus{border-color:var(--primary)!important;box-shadow:0 0 10px #00f0ff4d!important}.gt-container .gt-btn{background:linear-gradient(135deg,var(--primary),var(--primary-dark))!important;border:none!important;color:#fff!important;transition:all .3s ease!important}.gt-container .gt-btn:hover{box-shadow:0 0 15px #00f0ff80!important;transform:translateY(-2px)}.gt-container .gt-btn-preview{background:#b44aff33!important;border:1px solid rgba(180,74,255,.5)!important;color:var(--secondary)!important}.gt-container .gt-comment-content{background:#0a0e1799!important;border:1px solid rgba(0,240,255,.1)!important;color:#e0e0e0!important}.gt-container .gt-comment-content:hover{box-shadow:0 0 10px #00f0ff33!important}.gt-container a{color:var(--primary)!important}.gt-container a:hover{color:var(--secondary)!important}.gt-container .gt-comment-username{color:var(--primary)!important;font-weight:600!important}.gt-container .gt-comment-date{color:#888!important}.gt-container .gt-svg svg{fill:var(--primary)!important}.gt-container .gt-comment-admin .gt-comment-content{border-left:3px solid var(--primary)!important}
</style></head> <body> <div class="reading-progress" id="reading-progress"></div> <script type="module">const n=document.getElementById("reading-progress");n&&window.addEventListener("scroll",()=>{const e=document.documentElement.scrollHeight-window.innerHeight,t=e>0?window.scrollY/e*100:0;n.style.width=`${t}%`});</script> <div class="layout"> <aside class="sidebar"> <div class="sidebar-inner"> <div class="site-author"> <a href="/"> <img class="avatar" src="/images/header.png" alt="Keven" width="96" height="96"> </a> <h2 class="author-name">Keven</h2> <p class="site-subtitle" id="typing-subtitle"></p> </div> <nav class="site-nav"> <a href="/" class="nav-item"> <span class="nav-icon">ğŸ </span> <span>é¦–é¡µ</span> </a><a href="/archives/" class="nav-item"> <span class="nav-icon">ğŸ“¦</span> <span>å½’æ¡£</span> </a><a href="/tags/" class="nav-item"> <span class="nav-icon">ğŸ·ï¸</span> <span>æ ‡ç­¾</span> </a><a href="/categories/" class="nav-item"> <span class="nav-icon">ğŸ“‚</span> <span>åˆ†ç±»</span> </a><a href="/games/" class="nav-item"> <span class="nav-icon">ğŸ®</span> <span>å°æ¸¸æˆ</span> </a> </nav> <div class="sidebar-footer"> <a href="https://github.com/Kevencaz" target="_blank" rel="noopener" class="github-link">
GitHub â†—
</a> </div> </div> </aside> <div class="main-wrapper"> <main class="main-content">  <article class="post-detail"> <header class="post-header"> <h1 class="post-title" style="background:linear-gradient(135deg,var(--primary),var(--primary-dark));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;"> ç¼“å­˜è®¾è®¡å…¥é—¨ï¼šCache Asideã€TTL ä¸ä¸€è‡´æ€§å–èˆï½œå¿«é€Ÿä¸Šæ‰‹ </h1> <div class="post-meta"> <time datetime="2019-08-13T08:20:13.000Z">2019/08/13</time> <span class="post-tags"> <a href="/tags/ç¼“å­˜/" class="tag">#ç¼“å­˜</a><a href="/tags/åç«¯/" class="tag">#åç«¯</a> </span> </div> </header> <div class="post-body"> <blockquote>
<p>ç¼“å­˜ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œè¾¹ç•Œå’Œå¤±æ•ˆç­–ç•¥æ‰æ˜¯å…³é”®ã€‚</p>
</blockquote>
<!-- more -->
<h2 id="å¼€ç¯‡">å¼€ç¯‡</h2>
<p>è¿™ç¯‡æ–‡ç« é¢å‘ç‹¬ç«‹å¼€å‘è€…ï¼Œä»æ€§èƒ½è§†è§’æ·±å…¥æ‹†è§£ç¼“å­˜è®¾è®¡å…¥é—¨ã€‚å½“å‰å®šä½ä¸ºã€Œå…¥é—¨ã€é˜¶æ®µï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯å»ºç«‹åŸºæœ¬æ¦‚å¿µä¸æœ€å°é—­ç¯ã€‚æˆ‘ä»¬ä¼šä»å®é™…åœºæ™¯å‡ºå‘ï¼Œç»“åˆå…·ä½“ä»£ç ç¤ºä¾‹ï¼ŒæŠŠå…³é”®çŸ¥è¯†ç‚¹æ‹†è§£ä¸ºå¯è½åœ°çš„è¡ŒåŠ¨æ­¥éª¤ã€‚è¡¡é‡æ ‡å‡†ï¼šP95/P99 å»¶è¿Ÿã€‚</p>
<h2 id="é—®é¢˜æ‹†è§£">é—®é¢˜æ‹†è§£</h2>
<p>ç¼“å­˜æ˜¯åç«¯ç³»ç»Ÿä¸­æœ€å¸¸ç”¨çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µï¼Œä½†ä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºé—®é¢˜çš„åœ°æ–¹ã€‚â€œç¼“å­˜ä¸€æ—¶çˆ½ï¼Œä¸€è‡´æ€§ç«è‘¬åœºâ€è¿™å¥è¯è™½ç„¶å¤¸å¼ ï¼Œä½†ç¡®å®åæ˜ äº†ç°å®ã€‚å¾ˆå¤šçº¿ä¸Šäº‹æ•…çš„æ ¹å› éƒ½æ˜¯ç¼“å­˜æ•°æ®ä¸æ•°æ®åº“ä¸ä¸€è‡´ï¼Œæˆ–è€…ç¼“å­˜é›ªå´©å¯¼è‡´æ•°æ®åº“è¢«æ‰“å®ã€‚ç†è§£ç¼“å­˜çš„è®¾è®¡æ¨¡å¼å’Œå¤±æ•ˆç­–ç•¥ï¼Œæ˜¯åç«¯å·¥ç¨‹å¸ˆçš„å¿…ä¿®è¯¾ã€‚</p>
<p>æ•°æ®åº“çš„ QPS ä¸Šé™é€šå¸¸åœ¨å‡ åƒåˆ°å‡ ä¸‡ï¼Œè€Œ Redis è¿™æ ·çš„ç¼“å­˜ç³»ç»Ÿå¯ä»¥è½»æ¾è¾¾åˆ°åä¸‡çº§ã€‚å¯¹äºè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œç¼“å­˜èƒ½å°†å“åº”æ—¶é—´ä»å‡ åæ¯«ç§’é™åˆ°äºšæ¯«ç§’çº§ã€‚ä½†ç¼“å­˜å¼•å…¥äº†æ•°æ®ä¸€è‡´æ€§çš„æŒ‘æˆ˜ï¼šå½“æ•°æ®åº“æ›´æ–°äº†ï¼Œç¼“å­˜é‡Œçš„æ—§æ•°æ®æ€ä¹ˆåŠï¼Ÿä¸åŒçš„ä¸šåŠ¡åœºæ™¯å¯¹ä¸€è‡´æ€§çš„å®¹å¿åº¦ä¸åŒï¼Œè¿™å†³å®šäº†ä½ åº”è¯¥é€‰æ‹©å“ªç§ç¼“å­˜ç­–ç•¥ã€‚</p>
<h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h2>
<p>æœ€å¸¸ç”¨çš„ç¼“å­˜æ¨¡å¼æ˜¯ Cache Asideï¼ˆæ—è·¯ç¼“å­˜ï¼‰ï¼š</p>
<p>è¯»æµç¨‹ï¼šå…ˆæŸ¥ç¼“å­˜ï¼Œå‘½ä¸­åˆ™ç›´æ¥è¿”å›ï¼›æœªå‘½ä¸­åˆ™æŸ¥æ•°æ®åº“ï¼Œå°†ç»“æœå†™å…¥ç¼“å­˜åè¿”å›ã€‚
å†™æµç¨‹ï¼šå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜ï¼ˆè€Œä¸æ˜¯æ›´æ–°ç¼“å­˜ï¼‰ã€‚</p>
<p>ä¸ºä»€ä¹ˆæ˜¯â€åˆ é™¤â€è€Œä¸æ˜¯â€æ›´æ–°â€ç¼“å­˜ï¼Ÿå› ä¸ºåœ¨å¹¶å‘åœºæ™¯ä¸‹ï¼Œä¸¤ä¸ªå†™è¯·æ±‚å¯èƒ½å¯¼è‡´ç¼“å­˜ä¸­å­˜å‚¨äº†æ—§å€¼ã€‚åˆ é™¤ç¼“å­˜è®©ä¸‹ä¸€æ¬¡è¯»è¯·æ±‚è‡ªç„¶å›æºï¼Œä¿è¯æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
<p>TTLï¼ˆTime To Liveï¼‰æ˜¯ç¼“å­˜çš„å®‰å…¨ç½‘ã€‚å³ä½¿åˆ é™¤æ“ä½œå¤±è´¥ï¼ŒTTL åˆ°æœŸåç¼“å­˜ä¹Ÿä¼šè‡ªåŠ¨å¤±æ•ˆã€‚å»ºè®®æ ¹æ®ä¸šåŠ¡å®¹å¿åº¦è®¾ç½® TTLï¼šç”¨æˆ·ä¿¡æ¯ 5-15 åˆ†é’Ÿï¼Œé…ç½®æ•°æ® 1-5 åˆ†é’Ÿï¼Œçƒ­ç‚¹æ•°æ® 30-60 ç§’ã€‚</p>
<p>å¯¹äºä¸€è‡´æ€§è¦æ±‚æ›´é«˜çš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨å»¶è¿ŸåŒåˆ ï¼šå…ˆåˆ ç¼“å­˜ï¼Œæ›´æ–°æ•°æ®åº“ï¼Œç­‰å¾…ä¸€å°æ®µæ—¶é—´åå†åˆ ä¸€æ¬¡ç¼“å­˜ï¼Œè¦†ç›–å¯èƒ½çš„å¹¶å‘è¯»å›å¡«ã€‚</p>
<h2 id="ä»£ç å®æˆ˜">ä»£ç å®æˆ˜</h2>
<p>åœ¨ä» 0 åˆ° 1 çš„æ–°é¡¹ç›®çš„å®é™…åœºæ™¯ä¸­ï¼Œä¸‹é¢çš„ä»£ç æ¨¡å¼éå¸¸å®ç”¨ï¼š</p>
<pre class="astro-code one-dark-pro" style="background-color:#282c34;color:#abb2bf; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word;" tabindex="0" data-language="js"><code><span class="line"><span style="color:#7F848E;font-style:italic">// Cache Aside è¯»æµç¨‹</span></span>
<span class="line"><span style="color:#C678DD">async</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> getUser</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">id</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">  const</span><span style="color:#E5C07B"> key</span><span style="color:#56B6C2"> =</span><span style="color:#98C379"> `user:</span><span style="color:#C678DD">${</span><span style="color:#E06C75">id</span><span style="color:#C678DD">}</span><span style="color:#98C379">`</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#C678DD">  let</span><span style="color:#E06C75"> data</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> await</span><span style="color:#E5C07B"> redis</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">get</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">key</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">data</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">return</span><span style="color:#E5C07B"> JSON</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">parse</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">data</span><span style="color:#ABB2BF">); </span><span style="color:#7F848E;font-style:italic">// ç¼“å­˜å‘½ä¸­</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75">  data</span><span style="color:#56B6C2"> =</span><span style="color:#C678DD"> await</span><span style="color:#E5C07B"> db</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">query</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'SELECT * FROM users WHERE id = ?'</span><span style="color:#ABB2BF">, [</span><span style="color:#E06C75">id</span><span style="color:#ABB2BF">]);</span></span>
<span class="line"><span style="color:#C678DD">  if</span><span style="color:#ABB2BF"> (</span><span style="color:#E06C75">data</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic">    // å›å¡«ç¼“å­˜ï¼ŒTTL 5åˆ†é’Ÿ + éšæœºåç§»é˜²é›ªå´©</span></span>
<span class="line"><span style="color:#C678DD">    const</span><span style="color:#E5C07B"> ttl</span><span style="color:#56B6C2"> =</span><span style="color:#D19A66"> 300</span><span style="color:#56B6C2"> +</span><span style="color:#E5C07B"> Math</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">floor</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">Math</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">random</span><span style="color:#ABB2BF">() </span><span style="color:#56B6C2">*</span><span style="color:#D19A66"> 60</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#C678DD">    await</span><span style="color:#E5C07B"> redis</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">set</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">key</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">JSON</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">stringify</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">data</span><span style="color:#ABB2BF">), </span><span style="color:#98C379">'EX'</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">ttl</span><span style="color:#ABB2BF">);</span></span>
<span class="line"><span style="color:#ABB2BF">  }</span></span>
<span class="line"><span style="color:#C678DD">  return</span><span style="color:#E06C75"> data</span><span style="color:#ABB2BF">;</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic">// Cache Aside å†™æµç¨‹</span></span>
<span class="line"><span style="color:#C678DD">async</span><span style="color:#C678DD"> function</span><span style="color:#61AFEF"> updateUser</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75;font-style:italic">id</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">updates</span><span style="color:#ABB2BF">) {</span></span>
<span class="line"><span style="color:#C678DD">  await</span><span style="color:#E5C07B"> db</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">query</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">'UPDATE users SET ? WHERE id = ?'</span><span style="color:#ABB2BF">, [</span><span style="color:#E06C75">updates</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">id</span><span style="color:#ABB2BF">]);</span></span>
<span class="line"><span style="color:#C678DD">  await</span><span style="color:#E5C07B"> redis</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">del</span><span style="color:#ABB2BF">(</span><span style="color:#98C379">`user:</span><span style="color:#C678DD">${</span><span style="color:#E06C75">id</span><span style="color:#C678DD">}</span><span style="color:#98C379">`</span><span style="color:#ABB2BF">); </span><span style="color:#7F848E;font-style:italic">// å…ˆæ›´æ–°åº“ï¼Œå†åˆ ç¼“å­˜</span></span>
<span class="line"><span style="color:#ABB2BF">}</span></span></code></pre>
<h2 id="å·¥ç¨‹åŒ–è½åœ°">å·¥ç¨‹åŒ–è½åœ°</h2>
<p>å®é™…è½åœ°æ—¶ï¼Œè¿˜éœ€è¦è€ƒè™‘ç¼“å­˜ç©¿é€ï¼ˆæŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®ï¼‰ã€ç¼“å­˜å‡»ç©¿ï¼ˆçƒ­ç‚¹ Key è¿‡æœŸç¬é—´å¤§é‡è¯·æ±‚æ‰“åˆ°æ•°æ®åº“ï¼‰å’Œç¼“å­˜é›ªå´©ï¼ˆå¤§é‡ Key åŒæ—¶è¿‡æœŸï¼‰ã€‚åº”å¯¹æ–¹æ¡ˆåˆ†åˆ«æ˜¯ï¼šå¸ƒéš†è¿‡æ»¤å™¨æˆ–ç¼“å­˜ç©ºå€¼ã€äº’æ–¥é”æˆ–æ°¸ä¸è¿‡æœŸ+å¼‚æ­¥æ›´æ–°ã€TTL åŠ éšæœºåç§»é‡ã€‚ç›‘æ§æ–¹é¢ï¼Œé‡ç‚¹å…³æ³¨ç¼“å­˜å‘½ä¸­ç‡ï¼ˆç›®æ ‡ > 95%ï¼‰å’Œå›æº QPSã€‚</p>
<p>å¯¹äºç‹¬ç«‹å¼€å‘è€…æ¥è¯´ï¼Œå»ºè®®ä»æœ€å°å¯è¡Œæ–¹æ¡ˆå¼€å§‹ï¼Œå…ˆè·‘é€šæ ¸å¿ƒæµç¨‹ï¼Œå†é€æ­¥å®Œå–„è¾¹ç•Œå¤„ç†å’Œç›‘æ§å‘Šè­¦ã€‚ä¸è¦è¯•å›¾ä¸€æ¬¡æ€§åšåˆ°å®Œç¾ï¼Œå»ºç«‹åŸºæœ¬æ¦‚å¿µä¸æœ€å°é—­ç¯æ‰æ˜¯å½“å‰é˜¶æ®µçš„é‡ç‚¹ã€‚</p>
<h2 id="é¿å‘æ¸…å•">é¿å‘æ¸…å•</h2>
<p>æœ€å¸¸è§çš„é”™è¯¯æ˜¯â€å…ˆåˆ ç¼“å­˜å†æ›´æ–°æ•°æ®åº“â€ï¼Œè¿™åœ¨å¹¶å‘ä¸‹å‡ ä¹å¿…ç„¶å¯¼è‡´è„æ•°æ®ã€‚å…¶æ¬¡æ˜¯ TTL è®¾ç½®è¿‡é•¿ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„çª—å£æœŸå¤ªå¤§ã€‚è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯ç¼“å­˜äº†è¿‡å¤šçš„å†·æ•°æ®ï¼Œå ç”¨å†…å­˜ä½†å‘½ä¸­ç‡å¾ˆä½â€”â€”ç¼“å­˜åº”è¯¥åªå­˜çƒ­æ•°æ®ã€‚</p>
<h2 id="æ€»ç»“ä¸å±•æœ›">æ€»ç»“ä¸å±•æœ›</h2>
<p>æœ¬æ–‡ä»æ€§èƒ½è§†è§’æ¢³ç†äº†ç¼“å­˜è®¾è®¡å…¥é—¨åœ¨å…¥é—¨é˜¶æ®µçš„å…³é”®å®è·µã€‚æ ¸å¿ƒæŒ‡æ ‡æ˜¯P95/P99 å»¶è¿Ÿï¼Œæœ€å¤§é£é™©æ˜¯åªä¼˜åŒ–å±€éƒ¨å¯¼è‡´ç“¶é¢ˆè¿ç§»ã€‚å¸Œæœ›è¿™äº›ç»éªŒèƒ½å¸®ä½ å°‘èµ°å¼¯è·¯ï¼Œåœ¨ä» 0 åˆ° 1 çš„æ–°é¡¹ç›®ä¸­æ›´ä»å®¹åœ°æ¨è¿›ã€‚</p> </div> </article>  <div id="gitalk-container" data-id="2019-08-13-ç¼“å­˜è®¾è®¡å…¥é—¨-cache-aside-ttl-ä¸ä¸€è‡´æ€§å–èˆ-å¿«é€Ÿä¸Šæ‰‹" data-title="ç¼“å­˜è®¾è®¡å…¥é—¨ï¼šCache Asideã€TTL ä¸ä¸€è‡´æ€§å–èˆï½œå¿«é€Ÿä¸Šæ‰‹"></div> <script type="module" src="/_astro/Gitalk.astro_astro_type_script_index_0_lang.Cal0MJAU.js"></script>   <footer class="site-footer"> <div class="footer-inner"> <span>Â© 2019â€“2026 Keven</span> <span class="heart">â¤ï¸</span> <span>Powered by <a href="https://astro.build" target="_blank" rel="noopener">Astro</a></span> </div> <div class="visitor-stats"> <span id="busuanzi_container_site_pv">
ğŸ‘€ æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv">-</span> æ¬¡
</span> <span id="busuanzi_container_site_uv">
ğŸ‘¤ è®¿å®¢æ•° <span id="busuanzi_value_site_uv">-</span> äºº
</span> </div> </footer> </main> </div> </div> <button class="back-to-top" id="back-to-top" aria-label="å›åˆ°é¡¶éƒ¨" title="å›åˆ°é¡¶éƒ¨">â†‘</button> <script type="module">const o=document.getElementById("back-to-top");o&&(window.addEventListener("scroll",()=>{o.classList.toggle("visible",window.scrollY>300)}),o.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}));</script> <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> <script>(function(){const typingTexts = ["Welcome to my blog ğŸš€","è®°å½•å­¦ä¹ ï¼Œåˆ†äº«æˆé•¿ âœ¨","Code Â· Think Â· Create ğŸ’¡"];

    // é¼ æ ‡ç‚¹å‡»çƒŸèŠ±ç‰¹æ•ˆ
    document.addEventListener('click', function(e) {
      const colors = ['#00f0ff','#b44aff','#ff2d95','#39ff14','#ffe600','#00f0ff'];
      for (let i = 0; i < 12; i++) {
        const dot = document.createElement('div');
        dot.style.cssText = `position:fixed;pointer-events:none;width:6px;height:6px;border-radius:50%;z-index:99999;left:${e.clientX}px;top:${e.clientY}px;background:${colors[Math.floor(Math.random()*colors.length)]}`;
        document.body.appendChild(dot);
        const angle = (Math.PI * 2 / 12) * i;
        const velocity = 60 + Math.random() * 60;
        const dx = Math.cos(angle) * velocity;
        const dy = Math.sin(angle) * velocity;
        const x = e.clientX, y = e.clientY;
        let start = null;
        function anim(ts) {
          if (!start) start = ts;
          const p = (ts - start) / 600;
          if (p >= 1) { dot.remove(); return; }
          dot.style.left = (x + dx * p) + 'px';
          dot.style.top = (y + dy * p + 40 * p * p) + 'px';
          dot.style.opacity = String(1 - p);
          dot.style.transform = `scale(${1 - p * 0.5})`;
          requestAnimationFrame(anim);
        }
        requestAnimationFrame(anim);
      }
    });
    // åŠ¨æ€æ‰“å­—å‰¯æ ‡é¢˜
    const el = document.getElementById('typing-subtitle');
    if (el) {
      const texts = typingTexts;
      let ti = 0, ci = 0, deleting = false;
      function tick() {
        const current = texts[ti];
        if (!deleting) {
          el.textContent = current.substring(0, ci + 1);
          ci++;
          if (ci >= current.length) { deleting = true; setTimeout(tick, 1800); return; }
          setTimeout(tick, 80);
        } else {
          el.textContent = current.substring(0, ci - 1);
          ci--;
          if (ci <= 0) { deleting = false; ti = (ti + 1) % texts.length; setTimeout(tick, 400); return; }
          setTimeout(tick, 40);
        }
      }
      tick();
    }
  })();</script> </body> </html>